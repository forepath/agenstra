/**
 * InvoiceNinja client API expects country_id (numeric) not country (code).
 * This map is the official InvoiceNinja country list; only these IDs are valid.
 * See: https://github.com/invoiceninja/invoiceninja
 */

/** Alpha-2 code -> InvoiceNinja country_id */
export const ALPHA2_TO_COUNTRY_ID: Record<string, number> = {
  AF: 4,
  AL: 8,
  AQ: 10,
  DZ: 12,
  AS: 16,
  AD: 20,
  AO: 24,
  AG: 28,
  AZ: 31,
  AR: 32,
  AU: 36,
  AT: 40,
  BS: 44,
  BH: 48,
  BD: 50,
  AM: 51,
  BB: 52,
  BE: 56,
  BM: 60,
  BT: 64,
  BO: 68,
  BA: 70,
  BW: 72,
  BV: 74,
  BR: 76,
  BZ: 84,
  IO: 86,
  SB: 90,
  VG: 92,
  BN: 96,
  BG: 100,
  MM: 104,
  BI: 108,
  BY: 112,
  KH: 116,
  CM: 120,
  CA: 124,
  CV: 132,
  KY: 136,
  CF: 140,
  LK: 144,
  TD: 148,
  CL: 152,
  CN: 156,
  TW: 158,
  CX: 162,
  CC: 166,
  CO: 170,
  KM: 174,
  YT: 175,
  CG: 178,
  CD: 180,
  CK: 184,
  CR: 188,
  HR: 191,
  CU: 192,
  CY: 196,
  CZ: 203,
  BJ: 204,
  DK: 208,
  DM: 212,
  DO: 214,
  EC: 218,
  SV: 222,
  GQ: 226,
  ET: 231,
  ER: 232,
  EE: 233,
  FO: 234,
  FK: 238,
  GS: 239,
  FJ: 242,
  FI: 246,
  AX: 248,
  FR: 250,
  GF: 254,
  PF: 258,
  TF: 260,
  DJ: 262,
  GA: 266,
  GE: 268,
  GM: 270,
  PS: 275,
  DE: 276,
  GH: 288,
  GI: 292,
  KI: 296,
  GR: 300,
  GL: 304,
  GD: 308,
  GP: 312,
  GU: 316,
  GT: 320,
  GN: 324,
  GY: 328,
  HT: 332,
  HM: 334,
  VA: 336,
  HN: 340,
  HK: 344,
  HU: 348,
  IS: 352,
  IN: 356,
  ID: 360,
  IR: 364,
  IQ: 368,
  IE: 372,
  IL: 376,
  IT: 380,
  CI: 384,
  JM: 388,
  JP: 392,
  KZ: 398,
  JO: 400,
  KE: 404,
  KP: 408,
  KR: 410,
  KW: 414,
  KG: 417,
  LA: 418,
  LB: 422,
  LS: 426,
  LV: 428,
  LR: 430,
  LY: 434,
  LI: 438,
  LT: 440,
  LU: 442,
  MO: 446,
  MG: 450,
  MW: 454,
  MY: 458,
  MV: 462,
  ML: 466,
  MT: 470,
  MQ: 474,
  MR: 478,
  MU: 480,
  MX: 484,
  MC: 492,
  MN: 496,
  MD: 498,
  ME: 499,
  MS: 500,
  MA: 504,
  MZ: 508,
  OM: 512,
  NA: 516,
  NR: 520,
  NP: 524,
  NL: 528,
  CW: 531,
  AW: 533,
  SX: 534,
  BQ: 535,
  NC: 540,
  VU: 548,
  NZ: 554,
  NI: 558,
  NE: 562,
  NG: 566,
  NU: 570,
  NF: 574,
  NO: 578,
  MP: 580,
  UM: 581,
  FM: 583,
  MH: 584,
  PW: 585,
  PK: 586,
  PA: 591,
  PG: 598,
  PY: 600,
  PE: 604,
  PH: 608,
  PN: 612,
  PL: 616,
  PT: 620,
  GW: 624,
  TL: 626,
  PR: 630,
  QA: 634,
  RE: 638,
  RO: 642,
  RU: 643,
  RW: 646,
  BL: 652,
  SH: 654,
  KN: 659,
  AI: 660,
  LC: 662,
  MF: 663,
  PM: 666,
  VC: 670,
  SM: 674,
  ST: 678,
  SA: 682,
  SN: 686,
  RS: 688,
  SC: 690,
  SL: 694,
  SG: 702,
  SK: 703,
  VN: 704,
  SI: 705,
  SO: 706,
  ZA: 710,
  ZW: 716,
  ES: 724,
  SS: 728,
  SD: 729,
  EH: 732,
  SR: 740,
  SJ: 744,
  SZ: 748,
  SE: 752,
  CH: 756,
  SY: 760,
  TJ: 762,
  TH: 764,
  TG: 768,
  TK: 772,
  TO: 776,
  TT: 780,
  AE: 784,
  TN: 788,
  TR: 792,
  TM: 795,
  TC: 796,
  TV: 798,
  UG: 800,
  UA: 804,
  MK: 807,
  EG: 818,
  GB: 826,
  GG: 831,
  JE: 832,
  IM: 833,
  TZ: 834,
  US: 840,
  VI: 850,
  BF: 854,
  UY: 858,
  UZ: 860,
  VE: 862,
  WF: 876,
  WS: 882,
  YE: 887,
  ZM: 894,
};

/** Alpha-3 code -> InvoiceNinja country_id (for codes not in alpha-2 form) */
export const ALPHA3_TO_COUNTRY_ID: Record<string, number> = {
  AFG: 4,
  ALB: 8,
  ATA: 10,
  DZA: 12,
  ASM: 16,
  AND: 20,
  AGO: 24,
  ATG: 28,
  AZE: 31,
  ARG: 32,
  AUS: 36,
  AUT: 40,
  BHS: 44,
  BHR: 48,
  BGD: 50,
  ARM: 51,
  BRB: 52,
  BEL: 56,
  BMU: 60,
  BTN: 64,
  BOL: 68,
  BIH: 70,
  BWA: 72,
  BVT: 74,
  BRA: 76,
  BLZ: 84,
  IOT: 86,
  SLB: 90,
  VGB: 92,
  BRN: 96,
  BGR: 100,
  MMR: 104,
  BDI: 108,
  BLR: 112,
  KHM: 116,
  CMR: 120,
  CAN: 124,
  CPV: 132,
  CYM: 136,
  CAF: 140,
  LKA: 144,
  TCD: 148,
  CHL: 152,
  CHN: 156,
  TWN: 158,
  CXR: 162,
  CCK: 166,
  COL: 170,
  COM: 174,
  MYT: 175,
  COG: 178,
  COD: 180,
  COK: 184,
  CRI: 188,
  HRV: 191,
  CUB: 192,
  CYP: 196,
  CZE: 203,
  BEN: 204,
  DNK: 208,
  DMA: 212,
  DOM: 214,
  ECU: 218,
  SLV: 222,
  GNQ: 226,
  ETH: 231,
  ERI: 232,
  EST: 233,
  FRO: 234,
  FLK: 238,
  SGS: 239,
  FJI: 242,
  FIN: 246,
  ALA: 248,
  FRA: 250,
  GUF: 254,
  PYF: 258,
  ATF: 260,
  DJI: 262,
  GAB: 266,
  GEO: 268,
  GMB: 270,
  PSE: 275,
  DEU: 276,
  GHA: 288,
  GIB: 292,
  KIR: 296,
  GRC: 300,
  GRL: 304,
  GRD: 308,
  GLP: 312,
  GUM: 316,
  GTM: 320,
  GIN: 324,
  GUY: 328,
  HTI: 332,
  HMD: 334,
  VAT: 336,
  HND: 340,
  HKG: 344,
  HUN: 348,
  ISL: 352,
  IND: 356,
  IDN: 360,
  IRN: 364,
  IRQ: 368,
  IRL: 372,
  ISR: 376,
  ITA: 380,
  CIV: 384,
  JAM: 388,
  JPN: 392,
  KAZ: 398,
  JOR: 400,
  KEN: 404,
  PRK: 408,
  KOR: 410,
  KWT: 414,
  KGZ: 417,
  LAO: 418,
  LBN: 422,
  LSO: 426,
  LVA: 428,
  LBR: 430,
  LBY: 434,
  LIE: 438,
  LTU: 440,
  LUX: 442,
  MAC: 446,
  MDG: 450,
  MWI: 454,
  MYS: 458,
  MDV: 462,
  MLI: 466,
  MLT: 470,
  MTQ: 474,
  MRT: 478,
  MUS: 480,
  MEX: 484,
  MCO: 492,
  MNG: 496,
  MDA: 498,
  MNE: 499,
  MSR: 500,
  MAR: 504,
  MOZ: 508,
  OMN: 512,
  NAM: 516,
  NRU: 520,
  NPL: 524,
  NLD: 528,
  CUW: 531,
  ABW: 533,
  SXM: 534,
  BES: 535,
  NCL: 540,
  VUT: 548,
  NZL: 554,
  NIC: 558,
  NER: 562,
  NGA: 566,
  NIU: 570,
  NFK: 574,
  NOR: 578,
  MNP: 580,
  UMI: 581,
  FSM: 583,
  MHL: 584,
  PLW: 585,
  PAK: 586,
  PAN: 591,
  PNG: 598,
  PRY: 600,
  PER: 604,
  PHL: 608,
  PCN: 612,
  POL: 616,
  PRT: 620,
  GNB: 624,
  TLS: 626,
  PRI: 630,
  QAT: 634,
  REU: 638,
  ROU: 642,
  RUS: 643,
  RWA: 646,
  BLM: 652,
  SHN: 654,
  KNA: 659,
  AIA: 660,
  LCA: 662,
  MAF: 663,
  SPM: 666,
  VCT: 670,
  SMR: 674,
  STP: 678,
  SAU: 682,
  SEN: 686,
  SRB: 688,
  SYC: 690,
  SLE: 694,
  SGP: 702,
  SVK: 703,
  VNM: 704,
  SVN: 705,
  SOM: 706,
  ZAF: 710,
  ZWE: 716,
  ESP: 724,
  SSD: 728,
  SDN: 729,
  ESH: 732,
  SUR: 740,
  SJM: 744,
  SWZ: 748,
  SWE: 752,
  CHE: 756,
  SYR: 760,
  TJK: 762,
  THA: 764,
  TGO: 768,
  TKL: 772,
  TON: 776,
  TTO: 780,
  ARE: 784,
  TUN: 788,
  TUR: 792,
  TKM: 795,
  TCA: 796,
  TUV: 798,
  UGA: 800,
  UKR: 804,
  MKD: 807,
  EGY: 818,
  GBR: 826,
  GGY: 831,
  JEY: 832,
  IMN: 833,
  TZA: 834,
  USA: 840,
  VIR: 850,
  BFA: 854,
  URY: 858,
  UZB: 860,
  VEN: 862,
  WLF: 876,
  WSM: 882,
  YEM: 887,
  ZMB: 894,
};

/** Alpha-2 codes supported by InvoiceNinja (for frontend dropdown filter). */
export const INVOICE_NINJA_SUPPORTED_ALPHA2: readonly string[] = Object.keys(ALPHA2_TO_COUNTRY_ID).sort();

/**
 * Resolves InvoiceNinja country_id from ISO 3166-1 alpha-2 or alpha-3 code.
 * @param code - Two- or three-letter country code (case-insensitive)
 * @returns InvoiceNinja country_id or undefined if not supported
 */
export function getInvoiceNinjaCountryId(code: string | null | undefined): number | undefined {
  if (code == null || typeof code !== 'string') return undefined;
  const trimmed = code.trim();
  if (trimmed.length === 0) return undefined;
  const upper = trimmed.toUpperCase();
  if (upper.length === 2) return ALPHA2_TO_COUNTRY_ID[upper];
  if (upper.length === 3) return ALPHA3_TO_COUNTRY_ID[upper];
  return undefined;
}
