<!-- Standalone Loading Spinner Overlay -->
@if (showStandaloneLoading()) {
  <div
    class="position-fixed top-0 start-0 w-100 h-100 bg-body-tertiary d-flex justify-content-center align-items-center"
    style="z-index: 9999"
  >
    <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem">
      <span class="visually-hidden" i18n="@@featureContainer-loadingFile">Loading file...</span>
    </div>
  </div>
}

@if (!fileOnlyMode()) {
  <section class="bg-dark text-white d-flex align-items-center justify-content-between gap-2">
    <div class="d-flex align-items-center gap-3">
      <div class="brand-icon-container me-2 fs-3 bg-primary p-3">
        <img
          src="assets/images/icon_light.svg"
          alt="Agenstra"
          i18n-alt="@@featureContainer-brandAlt"
          class="brand-icon"
        />
      </div>
    </div>
    <div class="d-flex align-items-center gap-2">
      <!-- Dark Mode Toggle -->
      <div class="form-check form-switch me-3 mb-0">
        <input
          class="form-check-input"
          type="checkbox"
          role="switch"
          id="darkModeToggle"
          [checked]="themeService.isDarkMode()"
          (change)="themeService.toggleTheme()"
        />
        <label
          class="form-check-label text-white"
          for="darkModeToggle"
          i18n-title="@@featureContainer-toggleDarkMode"
          title="Toggle dark mode"
        >
          <i
            class="bi"
            [class.bi-moon-fill]="!themeService.isDarkMode()"
            [class.bi-sun-fill]="themeService.isDarkMode()"
          ></i>
        </label>
      </div>
      @if (isAuthenticated$ | async) {
        <button class="btn btn-primary me-3" (click)="onLogout()" i18n="@@featureContainer-logout">Logout</button>
      }
    </div>
  </section>
} @else {
  <!-- Dark Mode Toggle for Standalone Mode -->
  <section class="d-flex align-items-center justify-content-end gap-2 p-2 bg-dark text-white">
    <div class="form-check form-switch mb-0">
      <input
        class="form-check-input"
        type="checkbox"
        role="switch"
        id="darkModeToggleStandalone"
        [checked]="themeService.isDarkMode()"
        (change)="themeService.toggleTheme()"
      />
      <label
        class="form-check-label"
        for="darkModeToggleStandalone"
        i18n-title="@@featureContainer-toggleDarkMode"
        title="Toggle dark mode"
      >
        <i
          class="bi"
          [class.bi-moon-fill]="!themeService.isDarkMode()"
          [class.bi-sun-fill]="themeService.isDarkMode()"
        ></i>
      </label>
    </div>
  </section>
}
<div class="d-flex justify-content-end flex-grow-1">
  @if (isMainMask()) {
    @if (canAccessUserManager$ | async) {
      <aside class="sidebar bg-body-tertiary h-100">
        <button
          type="button"
          class="sidebar__item"
          (click)="onOpenUserManagerInNewWindow()"
          i18n-title="@@featureContainer-userManagementTitle"
          title="User Management (opens in new window)"
        >
          <i class="bi bi-people me-1"></i>
          <span class="small" i18n="@@featureContainer-users">Users</span>
        </button>
      </aside>
    }
  }
  <section class="section__container">
    <router-outlet></router-outlet>
  </section>
</div>
